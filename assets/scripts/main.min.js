var socket=io(),player,turn=!1;$("#formJoin").submit(function(){var a=$("#username").val();return socket.emit("join",a),!1}),socket.on("new player",function(a){2==a.players.length?($(".player1 span").text(a.players[0].name),$(".player2 span").text(a.players[1].name)):($(".player1 span").text(a.players[0].name),$(".player2 span").text("Aguardando jogador.")),$("#game").addClass("active"),$("#login").removeClass("active")}),socket.on("left game",function(a){alert("O jogador "+a.player.name+" saiu do jogo!")}),socket.on("game over",function(a){setTimeout(function(){a.winner==player?($("#gameover").text("Parabéns, você venceu o jogo!"),$("#gameover").addClass("success")):($("#gameover").text("Você perdeu o jogo!"),$("#gameover").addClass("failure")),$("#gameover").fadeIn()},2e3)}),socket.on("start game",function(a){$(".player1 strong").text(a.cardsqty.deck1),$(".player2 strong").text(a.cardsqty.deck2),player=parseInt(a.pindex)+1,$.each(a.deck,function(a,b){"img"==a?$("#cards-player"+player+" img").attr("src",b):$("#cards-player"+player+' ul li span[rel="'+a+'"]').text(b)}),setTimeout(function(){$("#cards-player"+player+" .cardinactive").addClass("cardoff"),setTimeout(function(){$("#cards-player"+player+" .carddefault").removeClass("cardoff"),1==player?($("#msg").text("Sua vez!"),$("#msg").removeClass("failure success info").addClass("info"),turn=!0):($("#msg").text("Vez do adversário!"),$("#msg").removeClass("failure success info").addClass("info")),$("#msg").show()},600)},500)}),socket.on("new play",function(a){$('.cardactive ul li span[rel="'+a.key+'"]').parent().addClass("active"),1==player?($.each(a.card2,function(a,b){"img"==a?$("#cards-player2 img").attr("src",b):$('#cards-player2 ul li span[rel="'+a+'"]').text(b)}),$("#cards-player2 .cardactive").removeClass("cardoff")):($.each(a.card1,function(a,b){"img"==a?$("#cards-player1 img").attr("src",b):$('#cards-player1 ul li span[rel="'+a+'"]').text(b)}),$("#cards-player1 .cardactive").removeClass("cardoff"))}),socket.on("new turn",function(a){a.winner==player?($("#msg").text("Você venceu!"),$("#msg").removeClass("failure success info").addClass("success")):($("#msg").text("Você perdeu!"),$("#msg").removeClass("failure success info").addClass("failure")),$("#msg").addClass("active"),setTimeout(function(){$("#msg").removeClass("active"),$(".cardactive").addClass("cardoff"),setTimeout(function(){$.each(a.deck,function(a,b){"img"==a?$("#cards-player"+player+" img").attr("src",b):$("#cards-player"+player+' ul li span[rel="'+a+'"]').text(b)}),$(".cardactive li").removeClass("active"),setTimeout(function(){$("#cards-player"+player+" .cardinactive").addClass("cardoff"),setTimeout(function(){$("#cards-player"+player+" .carddefault").removeClass("cardoff"),a.turn==player?($("#msg").text("Sua vez!"),$("#msg").removeClass("failure success info").addClass("info"),turn=!0):($("#msg").text("Vez do adversário!"),$("#msg").removeClass("failure success info").addClass("info")),$("#msg").show()},600)},500)},500)},2e3)}),$(".cardactive").on("click","li.clickable",function(a){if(turn){$(this).addClass("active");var b=$(this).children(".value").attr("rel");$('.cardactive ul li span[rel="'+b+'"]').parent().addClass("active"),socket.emit("play",{key:b,player:player}),turn=!1}else alert("Aguarde a jogada do adversário!")});